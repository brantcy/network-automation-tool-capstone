# Creates account for a batch of users from an imported .CSV file
# .CSV file = users.csv located in C:\powershell
# .csv file contains info in 3 columns: Name of user, samAccountName of user(login ID), OU in AD

Import-Module ActiveDirectory

Import-Csv "C:\powershell\users.csv" | ForEach-Object {
$userPrincipal = $_."samAccountName" + "@domain.local"

New-ADUser -Name $_.Name
-Path $_."ParentOU"
-SamAccountName $_."samAccountName"
-UserPrincipalName $userPrincipal

-AccountPassword (ConvertTo-SecureString "newpassword123"
-AsPlainText -Force)
-ChangePasswordAtLogon $true
-Enabled $true

Add-ADGroupMember "Tech Users"
$_."samAccountName";
}